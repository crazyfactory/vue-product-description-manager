<!DOCTYPE html>
<html>
<head>
  <title>Welcome to the ProductDescriptor</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <!-- <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script> -->
  <!-- get vue.js -->
  <!-- use vue-1.0.28.js (not 2.x.x) for vue-select -->
  <script src="./assets/vue-1.0.28.js"></script>
  <!-- get select extension -->
  <script src="./assets/vue-select-1.3.3.js"></script>
  <script src="./assets/moment.min.js"></script>

  <!-- load data -->
  <script src="config/categories.js"></script>
  <script src="config/attributes.js"></script>
  <script src="config/metatags.js"></script>
  <script src="config/materials.js"></script>

  <script src="config/api.js"></script>
  <!-- get css styles -->
  <link href="./assets/bootstrap-3.3.6.min.css" rel="stylesheet" type="text/css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/2.7.0/css/flag-icon.min.css" rel="stylesheet" type="text/css" />
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" type="text/css" href="assets/style.css" />
</head>
<body>
<div id="app">
  <div class="app-nav">
    <nav v-bind:class="headline" v-on:click.prevent>
      <a href="#" class="name" v-on:click="makeActive('names')">Names <i class="fa fa-commenting-o fa-2x fa-pull-right menu-icon" aria-hidden="true"></i></a>
      <a href="#" class="name" v-on:click="makeActive('material')">Material <i class="fa fa-industry fa-2x fa-pull-right menu-icon" aria-hidden="true"></i></a>
      <a href="#" class="metatags" v-on:click="makeActive('metatags')">Metatags <i class="fa fa-tags fa-2x fa-pull-right menu-icon" aria-hidden="true"></i></a>
      <a href="#" class="preview" v-on:click="makeActive('preview')">Preview <i class="fa fa-eye fa-pull-right fa-2x menu-icon" aria-hidden="true"></i></a>
      <a href="#" class="export" v-on:click="makeActive('export')">Export <i class="fa fa-database fa-pull-right fa-2x menu-icon" aria-hidden="true"></i></a>
      <a href="#" class="message" v-on:click="makeActive('admin')">Admin <i class="fa fa-user-secret fa-pull-right fa-2x menu-icon" aria-hidden="true"></i></a>

    </nav>
  </div>
  <!-- show active messages -->
  <div class="container messages">
    <div class="alert alert-[[message.type]]" v-for="message in messages | filterBy true in 'show'">
      <i class=date">[[message.date]]:</i>
      <span>[[message.message]]</span>
      <i class="fa fa-eye-slash fa-pull-right" aria-hidden="true" @click="hideMessage(message)" ></i>
    </div>
  </div>
  <!-- end active messages -->
  <!-- Settings button -->
  <div class="container">
    <i class="fa fa-cogs fa-2x fa-pull-right" aria-hidden="true" title="Set languages for Editor and Preview features" @click="toggle_settings"></i>
  </div>
  <!-- end settings button -->
  <!-- settings section -->
  <div class="container settings" v-show="show_settings">
    <ul class="list-group">
      <li class="list-group-item align-right">
        <section class="settings language_editor">
          <span class="icon_label">
            <i class="fa fa-pencil fa-2x" aria-hidden="true" title="Set Editor language"></i>
          </span>
          <span v-for="language in languages">
            <span class="language" @click="addEditorLanguage(language.id)">
              <i style="color:darkgreen;" class="fa fa-caret-right" aria-hidden="true" v-if="language.id == editorLanguage"></i>
              <span class="flag-icon [[language.flag]]" ></span>
            <i style="color:darkgreen;" class="fa fa-caret-left" aria-hidden="true" v-if="language.id == editorLanguage"></i>
          </span>
        </span>
        </section>
        <span class="settings seperator">|</span>
        <section class="settings language_preview">
          <span class="icon_label">
            <i class="fa fa fa-eye fa-2x" aria-hidden="true" title="Set/ unset languages for the preview feature"></i>
          </span>
        <span v-for="language in languages">
          <span class="language" @click="toggle_language(language)">
              <i style="color:darkred;" class="fa fa-circle-o" aria-hidden="true" v-if="!language.status"></i>
              <i style="color:darkgreen;" class="fa fa-check-circle-o" aria-hidden="true" v-if="language.status"></i>
              <span class="flag-icon [[language.flag]]" ></span>
          </span>
        </span>
        </section>
      </li>
    </ul>
  </div>
  <!-- end settings section -->
  <div class="container">
    <h3 class="headline"><span class="[[headline_icon]]"></span> [[headline]]</h3>
    <div v-bind:class="{ 'col-xs-12 col-sm-12 col-md-12': isFullScreen, 'col-xs-12 col-sm-6 col-md-6':isSmallScreen }">
      <section class="product-management load_products" v-on:click.stop v-show="show_load">
        <!-- Add Products -->
        <header class="header">
          <input class="new-product"
                 autofocus autocomplete="off"
                 placeholder="Enter products model code"
                 v-model="newProduct"
                 @keyup.enter="addProduct">
        </header>
        <!-- End add products -->
        <section class="main" v-show="products.length" v-cloak>
          <input class="toggle-all" type="checkbox" v-model="allActive">
          <!-- List products -->
          <ul class="product-list">
            <li v-for="product in products"
                class="product"
                :key="product.id"
                :class="{ active: product.active }">
              <div class="view">
                <input class="toggle" type="checkbox" v-model="product.active">
                <i class="destroy fa fa-trash-o fa-2x fa-pull-right" aria-hidden="true" @click="removeProduct(product)"></i>
                <label>[[product.modelCode]]</label>
                <!-- Generic Product Names by language -->
                <ul v-if="show_names && product.category" class="list-group indent">
                  <li class="list-group-item small" v-for="language in languages" v-show="language.status">
                    <span class="flag-icon [[language.flag]]" ></span>
                    <i class="fa fa-pencil fa-pull-right" title="Add custom name" aria-hidden="true" v-show="!product.names[language.id].edit" @click="editMe(product.names[language.id])"></i>
                    <span>
                      [[product.names[language.id].original_value ]]
                    </span>
                    <div class="customized_name"
                         v-if="(product.names[language.id].original_value!=product.names[language.id].value) || product.names[language.id].edit" >
                      <i class="fa fa-times-circle-o fa-pull-right" title="Close Editor" aria-hidden="true" v-show="product.names[language.id].edit" @click="closeEditMe(product.names[language.id])"></i>
                      <span v-show="!product.names[language.id].edit" @click="editMe(product.names[language.id])" class="fa fa-pencil-square-o fa-pull-left customized_name_icon" title="custom name for '[[language.id]]'"></span>
                      <span v-show="!product.names[language.id].edit" @click="editMe(product.names[language.id])">[[ product.names[language.id].value ]]</span>
                      <div class="editable" v-show="product.names[language.id].edit">
                        <textarea v-model="product.names[language.id].value" @keyup.esc="closeEditMe(product.names[language.id])" @keyup.enter="closeEditMe(product.names[language.id])"></textarea>
                      </div>
                      <i class="fa fa-trash-o fa-pull-right" aria-hidden="true" title="Delete custom name for '[[language.id]]'" @click="removeCustomName(product.names[language.id])"></i>
                    </div>
                  </li>
                </ul>
                <!-- End Product Names by language -->
                <div class="indent" v-if="show_material">
                  <!-- material configuration -->
                  <h6><span class="[[headline_icon]]"></span> [[  ]] </h6>
                  <!-- end material -->
                </div>
                <div v-if="show_metatags">
                  <!-- Meta tag preview -->
                  <ul  class="indent" v-if="product.metatags.length>0">
                    <li class="list-group-item small" v-for="language in languages" v-show="language.status">
                      <ul>
                        <li><span class="flag-icon [[language.flag]] fa-pull-left" style="margin-top:-8px; margin-left:-12px;"></span></li>
                        <li class="list-group-item" v-for="metatag in product.metatags" v-show="metatags[metatag]">
                          <i class="fa fa-trash-o fa-pull-right" aria-hidden="true" title="Delete this tag" @click="removeMetatag(product, metatag)"></i>
                          <i class="fa fa-eye fa-pull-right" aria-hidden="true" title="Hide for this language" @click="alert('hide me');"></i>
                          <span v-if="metatags[metatag]">
                              <i class="fa fa-tag fa-pull-left"></i> [[ metatags[metatag].label[language.id].value ]]
                          </span>
                           <span class="alias" v-if="metatags[metatag] && metatags[metatag].alias[language.id].value.length > 0">
                              <i class="fa fa-tags"></i>[[ metatags[metatag].alias[language.id].value ]]
                            </span>
                        </li>
                      </ul>

                    </li>
                  </ul>
                  <!-- Meta tag preview end -->
                </div>

                <!-- Preview Feature -->
                <div class="product_preview" v-on:click.stop v-if="show_preview">
                  <div class="indent">
                    <h5 class="product_name inline" v-if="product.category">Product Names:</h5>
                    <ul class="list-group" v-if="product.category">
                      <li class="list-group-item small" v-for="language in languages" v-show="language.status">
                        <i class="fa fa-pencil fa-pull-right" title="Add custom name" aria-hidden="true" v-show="!product.names[language.id].edit" @click="editMe(product.names[language.id])"></i>
                        <i class="fa fa-times-circle-o fa-pull-right" title="Close Editor" aria-hidden="true" v-show="product.names[language.id].edit" @click="closeEditMe(product.names[language.id])"></i>
                        <span class="flag-icon [[language.flag]]" ></span>
                        <span v-show="!product.names[language.id].edit" @click="editMe(product.names[language.id])">[[ product.names[language.id].value ]]</span>
                        <div class="editable" v-show="product.names[language.id].edit">
                          <textarea v-model="product.names[language.id].value" @keyup.enter="closeEditMe(product.names[language.id])" @keyup.esc="closeEditMe(product.names[language.id])"></textarea>
                        </div>
                      </li>
                    </ul>
                  </div>
                  <div v-if="product.descriptions" class="indent description">
                    <h5>Descriptions:</h5>
                    <ul class="list-group">
                      <!-- Language dependent items -->
                      <li class="list-group-item small" v-for="language in languages" v-show="language.status">
                        <i class="fa fa-pencil fa-pull-right" title="Add custom description" aria-hidden="true" v-show="!product.descriptions[language.id].edit" @click="editMe(product.descriptions[language.id])"></i>
                        <i class="fa fa-times-circle-o fa-pull-right" title="Close Editor" aria-hidden="true" v-show="product.descriptions[language.id].edit" @click="closeEditMe(product.descriptions[language.id])"></i>
                        <i class="fa fa-refresh fa-pull-right " title="Generate new description" aria-hidden="true" @click="getGeneratedDescription(product, language.id)"></i>
                        <span class="flag-icon [[language.flag]]" ></span>
                        <span v-show="!product.descriptions[language.id].edit" @click="editMe(product.descriptions[language.id])">[[product.descriptions[language.id].value]]</span>
                        <div class="editable" v-show="product.descriptions[language.id].edit">
                          <textarea v-model="product.descriptions[language.id].value" @keyup.enter="closeEditMe(product.descriptions[language.id])"></textarea>
                        </div>
                      </li>
                      <!-- end language dependent items -->
                    </ul>

                  </div>
                  <div v-if="product.metatags.length>0">
                    <h5 class="indent">Metatags:</h5>
                    <!-- Meta tag preview -->
                    <ul  class="indent" v-if="product.metatags.length>0">
                      <li class="list-group-item small" v-for="language in languages" v-show="language.status">
                        <ul>
                          <li><span class="flag-icon [[language.flag]] fa-pull-left" style="margin-top:-8px; margin-left:-12px;"></span></li>
                          <li class="list-group-item" v-for="metatag in product.metatags" v-show="metatags[metatag]">
                          <span v-if="metatags[metatag]">
                              <i class="fa fa-tag fa-pull-left"></i> [[ metatags[metatag].label[language.id].value ]]
                          </span>
                           <span class="alias" v-if="metatags[metatag] && metatags[metatag].alias[language.id].value.length > 0">
                              <i class="fa fa-tags"></i>[[ metatags[metatag].alias[language.id].value ]]
                            </span>
                          </li>
                        </ul>

                      </li>
                    </ul>
                    <!-- Meta tag preview end -->
                  </div>
                </div>
                <!-- Preview END -->
              </div>
            </li>
          </ul>
          <!-- End List products -->
        </section>
      </section>
    </div>
    <!-- Add Products end -->
    <!-- Add Product Names -->
    <div class="products_name row col-xs-12 col-sm-6 col-md-6" v-on:click.stop v-show="show_names">
      <div class="margin-bottom">
        <v-select :value.sync="selected_category" placeholder="Select a Category"
                  :options="category_options"
                  :get-option-label="getOptionLabel"></v-select>
      </div>
      <div class="margin-bottom">
        <v-select :value.sync="selected_attribute_1" placeholder="Select an attribute"
                  :options="attribute_options_1"
                  :get-option-label="getOptionLabel"></v-select>
      </div>
      <div class="margin-bottom">
        <v-select :value.sync="selected_attribute_2" placeholder="Select an other attribute"
                  :options="attribute_options_2"
                  :get-option-label="getOptionLabel"></v-select>
      </div>
      <div class="row">
        <div class="actions">
          <button type="button" class="btn btn-success save_name fa-pull-right" @click="saveNameScheme()"><i class="fa fa-commenting-o fa-2x" aria-hidden="true"></i> Save</button>
        </div>
      </div>
    </div>
    <!-- End Product Names  -->
    <div class="row col-xs-12 col-sm-6 col-md-6" v-if="show_material">
      <!-- Product Materials -->
      <div class="margin-bottom">
        <v-select :value.sync="selected_materials" placeholder="Select Material"
                  :options="materials"
                  :multiple="true"
                  :get-option-label="getOptionLabel">
        </v-select>
      </div>
      <div class="row">
        <div class="actions">
          <button type="button" class="btn btn-success fa-pull-right" @click="saveMaterials()"><i class="fa fa-industry fa-2x" aria-hidden="true"></i> Set Material</button>
        </div>
      </div>

      <!-- End Product Materials -->
    </div>
    <!-- Meta Tags -->
    <div class="products_metatags row col-xs-12 col-sm-6 col-md-6" v-on:click.stop v-show="show_metatags">
      <div class="margin-bottom">
        <v-select :value.sync="selected_metatags" placeholder="Select Metatags"
                  :options="metatag_objects"
                  :multiple="true"
                  :taggable="true"
                  :push-tags="true"
                  :create-option="createMetatagOption"
                  :get-option-label="getOptionLabelValue">
        </v-select>

      </div>
      <div class="row">
        <div class="actions">
          <button type="button" v-if="!show_metatags_edit" class="btn btn-success save_tags fa-pull-right" @click="saveMetatags()"><i class="fa fa-tags fa-2x" aria-hidden="true"></i> Set tags</button>
          <button type="button" v-if="!show_metatags_edit" class="btn btn-success edit_tags fa-pull-right" @click="editMetatags()"><i class="fa fa-pencil fa-2x" aria-hidden="true"></i> Edit</button>
        </div>
      </div>
      <div class="row" v-if="show_metatags_edit">
        <!-- Edit Metatags -->
        <i class="indent" v-if="!selected_metatags.length > 0">Please select Metatags to edit ...</i>
        <h5 class="indent" v-if="selected_metatags.length > 0">Edit Metatags  <i class="fa fa-times-circle-o fa-2x fa-pull-right close-edit-metatags" aria-hidden="true" @click="closeEditMetatags()"></i></h5>
        <ul class="indent metatag-list" v-if="selected_metatags.length > 0">
          <li class="list-group-item small" v-for="language in languages" v-show="language.status">
            <ul>
              <li><span class="flag-icon [[language.flag]] fa-pull-left" style="margin-top:-8px; margin-left:-12px;"></span></li>
              <li class="list-group-item" v-for="metatag in selected_metatags">
                  <span v-if="!metatags[metatag.id].label[language.id].edit">
                    <i class="fa fa-tag fa-pull-left"></i>
                    [[ metatags[metatag.id].label[language.id].value ]]
                    <span class="alias" v-if="metatags[metatag.id].alias[language.id].value.length > 0">
                      <i class="fa fa-tags"></i>[[ metatags[metatag.id].alias[language.id].value ]]
                    </span>
                     <i class="fa fa-pull-right fa-pencil" @click="editMe(metatags[metatag.id].label[language.id])"></i>
                  </span>
                <div v-if="metatags[metatag.id].label[language.id].edit">
                  <i class="fa fa-pull-right fa-times-circle-o" style="margin-top:-10px;" v-if="metatags[metatag.id].label[language.id].edit" @click="closeEditMe(metatags[metatag.id].label[language.id])"></i>
                  <h5><i class="fa fa-tag fa-pull-left"></i>Label</h5> <input class="full-width" v-model="metatags[metatag.id].label[language.id].value">
                </div>
                <div v-if="metatags[metatag.id].label[language.id].edit">
                  <h5><i class="fa fa-tags"></i> Aliases</h5>
                  <input class="full-width" v-model="metatags[metatag.id].alias[language.id].value"l>
                </div>
              </li>
            </ul>
          </li>
        </ul>
        <! End edit metatags -->
      </div>
    </div>
    <!-- End Meta Tag -->
    <!-- Export -->
    <div class="products_export row col-xs-12 col-sm-6 col-md-6" v-on:click.stop v-show="show_export">
      <h5>Export selected products to shop</h5>
      <button type="button" class="btn btn-success save_name" @click="alert('Not ready yet .... coming soon')"><i class="fa fa-database fa-2x" aria-hidden="true"></i> Save to DB</button>
    </div>
    <!-- End Export -->
    <!-- Messages -->
    <div class="message row col-xs-12 col-sm-12 col-md-12" v-on:click.stop v-show="show_message">
      <div>
        <h5>Admin Actions</h5>
        <ul class="list-group">
          <li class="list-group-item">
            <a href="#" class="error_report" v-on:click="alert('A message will be send to the admin with the errors listed below')"><i class="fa fa-share-square-o fa-2x" aria-hidden="true"></i> Share Errors </a>&nbsp;&nbsp;
            <a href="#" class="export" v-on:click="addMessage('test message dude', 'danger')"><i class="fa fa-plus-square fa-2x" aria-hidden="true"></i> Add Error message</a>&nbsp;&nbsp;
            <a href="#" class="export" v-on:click="removeMessages()"><i class="fa fa-trash-o fa-2x" aria-hidden="true"></i> Delete ALL messages</a>&nbsp;&nbsp;
            <a href="#" class="export" v-on:click="debugMessages()"><i class="fa fa-search fa-2x" aria-hidden="true"></i> Debug messages</a> &nbsp;&nbsp;
            <a href="#" class="export" v-on:click="clearSettings()"><i class="fa fa-trash-o fa-2x" aria-hidden="true"></i> Clear local settings</a>&nbsp;&nbsp;
            <a href="#" class="export" v-on:click="debugMetatags()"><i class="fa fa-search fa-2x" aria-hidden="true"></i> Debug Metatags</a>&nbsp;&nbsp;
            <a href="#" class="export" v-on:click="clearLocalMetatags()"><i class="fa fa-trash-o fa-2x" aria-hidden="true"></i> Clear local Metatags</a>&nbsp;&nbsp;
          </li>
        </ul>
        <h5>Error Messages <i class="fa fa-envelope-o" aria-hidden="true"></i></h5>
        <ul class="list-group">
          <li class="list-group-item" v-for="message in messages | filterBy 'danger' in 'type'">
            <div class="alert alert-[[message.type]]" >
              <i class=date">[[message.date]]:</i>
              <span>[[message.message]]</span>
              <i class="fa fa-trash-o fa-pull-right" aria-hidden="true" @click="removeMessage(message)" ></i>
            </div>

          </li>
        </ul>
      </div>
      <!-- End Messages -->
    </div>
  </div>
</div>

<script src="assets/app.js"></script>
</body>
</html>

